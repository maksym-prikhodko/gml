(window.webpackJsonp=window.webpackJsonp||[]).push([[5,22],{20:function(t,e,s){"use strict";s.r(e);var a={middleware:"auth",components:{VueEditor:s(59).a},props:["id"],data:function(){return{loaded:!1,loadId:null,item:Array,customToolbar:[["bold","italic","underline"],[{list:"ordered"},{list:"bullet"}],["link","image"]]}},mounted:function(){this.loadId=this.$props.id;var t=this;axios.all([axios.get("/api/tasks/"+t.id)]).then(axios.spread((function(e){t.loaded=!0,t.item=e.data.data})))},methods:{handleImageAdded:function(t,e,s,a){var i=new FormData;i.append("image",t),axios({url:"/api/image/upload",method:"POST",data:i}).then((function(t){var i=t.data.url;e.insertEmbed(s,"image",i),a()})).catch((function(t){console.log(t)}))},updateTask:function(){var t=this;axios.patch(["/api/tasks/"+this.item.id],this.item).then((function(t){})).catch((function(e){422===e.response.status&&(t.errors=e.response.data.errors||{},$.each(t.errors,(function(t,e){})))}))}}},i=s(1),o=Object(i.a)(a,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[t.loaded?s("div",{staticClass:"row p-4"},[s("div",{staticClass:"col-12 col-md-9"},[s("b-form-input",{staticClass:"inline-input mb-3 text-lg",attrs:{size:"lg",required:""},on:{change:function(e){return t.updateTask()}},model:{value:t.item.name,callback:function(e){t.$set(t.item,"name",e)},expression:"item.name"}}),t._v(" "),s("vue-editor",{staticClass:"inline-input",attrs:{id:"editor",editorToolbar:t.customToolbar,useCustomImageHandler:""},on:{blur:function(e){return t.updateTask()},"image-added":t.handleImageAdded},model:{value:t.item.desc,callback:function(e){t.$set(t.item,"desc",e)},expression:"item.desc"}})],1),t._v(" "),s("div",{staticClass:"col-12 col-md-3"},[t._v("\n      "+t._s(t.item.id)+"\n    ")])]):s("div",[s("div",{staticClass:"spinner-border text-secondary",attrs:{role:"status"}})])])}),[],!1,null,null,null);e.default=o.exports},21:function(t,e,s){"use strict";s.r(e);var a=s(6),i=s(20);function o(t,e,s){return e in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}var n={mixins:[a.ContainerMixin],template:"<div><slot /></div>"},r={mixins:[a.ElementMixin],props:["item"],template:'<div class="row slot-task"><slot /></div>'},l={middleware:"auth",props:["id"],components:{ContainerMixin:a.ContainerMixin,ElementMixin:a.ElementMixin,SortableItem:r,SortableList:n,Task:i.default},data:function(){return{loaded:!1,project:Array,tasks:Array,items:Array,newTaskOpen:!1,form:{name:"",project_id:null}}},mounted:function(){var t=this;this.$root.$on("bv::modal::hide",(function(e,s){t.loadTasks()})),this.id=this.$props.id,this.loadTasks()},methods:{loadTasks:function(){var t=this;axios.all([axios.get("/api/projects/"+t.id),axios.post(["/api/fetch/projects/tasks"],{projectId:t.id})]).then(axios.spread((function(e,s){t.loaded=!0,t.project=e.data.data,t.tasks=s.data.data,t.form.project_id=e.data.data.id,t.prepareDrag()})))},prepareDrag:function(){this.items=Object.values(this.tasks),0==this.items.length&&(this.newTaskOpen=!0)},toggleFocus:function(t,e){var s=this,a=o({},"id",e);axios.post(["/api/update/task/focus"],a,this.headers).then((function(e){1==s.items[t].focus?s.items[t].focus=0:s.items[t].focus=1})).catch((function(t){422===t.response.status&&(s.errors=t.response.data.errors||{},$.each(s.errors,(function(t,e){})))}))},toggleCompleted:function(t,e){var s=this,a=o({},"id",e);axios.post(["/api/update/task/completed"],a,this.headers).then((function(e){1==s.items[t].completed?s.items[t].completed=0:s.items[t].completed=1})).catch((function(t){422===t.response.status&&(s.errors=t.response.data.errors||{},$.each(s.errors,(function(t,e){})))}))},toggleNewTask:function(){this.newTaskOpen=!this.newTaskOpen},saveOrder:function(){var t=[];this.items.forEach((function(e){var s=[{id:e.id}];t.push(s)})),axios.post(["/api/order/tasks"],t).then((function(t){})).catch((function(t){}))},onSubmit:function(t){var e=this;t.preventDefault();var s={id:0,name:this.form.name,desc:null,focus:0,completed:0};this.items.unshift(s),axios.post(["/api/tasks"],this.form).then((function(t){e.form.name=null,e.loadTasks()})).catch((function(t){422===t.response.status&&(e.errors=t.response.data.errors||{},$.each(e.errors,(function(t,e){})))}))}}},c=(s(72),s(1)),d=Object(c.a)(l,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[t.loaded?s("div",[s("div",{staticClass:"row header"},[s("div",{staticClass:"col-10 col-sm-8"},[s("h3",{staticClass:"mb-4"},[t._v(t._s(t.$t("tasks")))])]),t._v(" "),s("div",{staticClass:"col-2 col-sm-4 text-right"},[t.newTaskOpen?s("h2",[s("BIconXCircle",{attrs:{variant:"secondary"},on:{click:function(e){return t.toggleNewTask()}}})],1):s("h2",[s("BIconPlusCircleFill",{attrs:{variant:"secondary"},on:{click:function(e){return t.toggleNewTask()}}})],1)])]),t._v(" "),s("div",{staticClass:"row new-task",class:{newTaskOpened:t.newTaskOpen}},[s("div",{staticClass:"col-12"},[s("span",{staticClass:"task-name"},[s("b-form",{on:{submit:t.onSubmit}},[s("b-input-group",[s("b-form-input",{attrs:{required:"",placeholder:t.$t("task_title_here")},model:{value:t.form.name,callback:function(e){t.$set(t.form,"name",e)},expression:"form.name"}}),t._v(" "),s("b-input-group-append",[s("b-button",{staticClass:"w-100",attrs:{type:"submit",variant:"primary"}},[t._v(t._s(t.$t("create")))])],1)],1)],1)],1)])]),t._v(" "),s("card",{attrs:{id:"tasks"}},[0==t.items.length?s("div",{staticClass:"text-center mt-5 mb-5"},[s("h1",[s("BIconFolder")],1),t._v(" "),s("p",[t._v(t._s(t.$t("add_your_first_task")))])]):t._e(),t._v(" "),s("SortableList",{attrs:{lockAxis:"y",distance:10},on:{input:function(e){return t.saveOrder()}},model:{value:t.items,callback:function(e){t.items=e},expression:"items"}},t._l(t.items,(function(e,a){return s("SortableItem",{key:parseInt(a),class:{completed:e.completed},attrs:{index:parseInt(a),value:e}},[s("div",{staticClass:"col-2 col-sm-1 text-center"},[0==e.completed?s("BIconCircle",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",modifiers:{hover:!0}}],staticClass:"pointer pull-right",attrs:{title:t.$t("mark_as_focus")},on:{click:function(s){return t.toggleCompleted(a,e.id)}}}):s("BIconCheckCircle",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",modifiers:{hover:!0}}],staticClass:"pointer pull-right",attrs:{title:t.$t("unmark_as_focus")},on:{click:function(s){return t.toggleCompleted(a,e.id)}}})],1),t._v(" "),s("div",{staticClass:"col-8 col-sm-10"},[s("span",{directives:[{name:"b-modal",rawName:"v-b-modal",value:"modal"+e.id,expression:"'modal'+item.id"}],staticClass:"task-name"},[t._v("\n              "+t._s(e.name)+"\n            ")]),t._v(" "),s("b-modal",{attrs:{id:"modal"+e.id,size:"xl",centered:"","header-class":"d-none","footer-class":"d-none"}},[s("Task",{attrs:{id:e.id}})],1)],1),t._v(" "),s("div",{staticClass:"col-2 col-sm-1 text-left text-sm-right"},[0==e.focus?s("BIconStar",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",modifiers:{hover:!0}}],staticClass:"pointer pull-right",attrs:{title:t.$t("mark_as_focus")},on:{click:function(s){return t.toggleFocus(a,e.id)}}}):s("BIconStarFill",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",modifiers:{hover:!0}}],staticClass:"pointer pull-right",attrs:{title:t.$t("unmark_as_focus")},on:{click:function(s){return t.toggleFocus(a,e.id)}}})],1)])})),1)],1)],1):s("div",[s("div",{staticClass:"spinner-border text-secondary",attrs:{role:"status"}})])])}),[],!1,null,null,null);e.default=d.exports},25:function(t,e,s){var a=s(73);"string"==typeof a&&(a=[[t.i,a,""]]);var i={hmr:!0,transform:void 0,insertInto:void 0};s(11)(a,i);a.locals&&(t.exports=a.locals)},72:function(t,e,s){"use strict";var a=s(25);s.n(a).a},73:function(t,e,s){(t.exports=s(10)(!1)).push([t.i,".new-task {\n  opacity: 0;\n  height: 0px;\n  margin-top: 0;\n  padding-top: 0;\n  transition: 0.3s;\n}\n.new-task.newTaskOpened {\n  opacity: 1;\n  height: inherit;\n  margin-bottom: 1em;\n}",""])}}]);
